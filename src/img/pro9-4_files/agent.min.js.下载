/*!
 * Agent.js v2.0.2
 * (c) 2020 Du Xiaoman Financial
 * Released under the MIT License.
 */
var Agent=function(){function n(n,t){return function(e){return t._config=e,n}}function t(n,t){return setTimeout(function(){return n()},t||0)}function e(){}function r(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"FATAL",r="[ Agent "+e+" ] "+t;if(!n){if("FATAL"===e)throw new Error(r);console.warn(r)}}function i(n){return n.replace(nn,o)}function o(n){return n?n.toUpperCase():""}function a(n){return Q.createElement(n)}function u(){return en++}function c(n,t){for(var e in n)if(n.hasOwnProperty(e)&&!1===t(n[e],e,n))break}function s(n,t){if(!n&&0!=n)return-1;if(void 0===t&&(t=n,n=H.wallet||0),n===t)return 0;n=(n+"").split("."),t=(t+"").split(".");for(var e=Math.max(n.length,t.length),r=0;r<e;r++){var i=parseInt(n[r]||0,10),o=parseInt(t[r]||0,10);if(i>o)return 1;if(i<o)return-1}return 0}function f(n,t){for(var e=Object.keys(n),r=e.length;r--;)t[e[r]]=n[e[r]];return t}function l(n){var e=a("iframe");e.src=n,e.style.width=e.style.height=0,e.style.visibility="hidden",Q.documentElement.appendChild(e),t(function(){e.parentNode.removeChild(e),e=null})}function d(){var n=this;X[an]&&H.ios&&(X[an].invoke=function(t,e,r,i,o){t||(t="defaultCommand"),e||(e={}),n.callbackId++,n.callbacks[n.callbackId]={success:r,fail:i},l(""+ln+t+o+"/"+JSON.stringify(e))})}function p(){return t(function(){return sn++,fn===sn?t(p,500):fn<sn?v("error"):b()?v("ready"):void 0})}function h(){p(),t(p,5e3)}function v(n){cn=n,rn.emit(n),rn.off("ready"===n?"error":"ready"),Q.removeEventListener(un,p),X.removeEventListener("load",h),p=e}function g(n,t){return"ready"===cn?n():"error"===cn?t():void("pending"===cn&&(rn.on("ready",n),rn.on("error",t)))}function m(n){var t={};return n=n.substr(0,n.length-1),c(n.split("};"),function(n){if(n){var e=n.split("={");t[e[0].replace("{","")]=e[1].replace(/}/g,"")}}),t}function y(n){var t=void 0;try{n=K(n)}catch(n){t=!0}if(t)try{n=m(n)}catch(n){}return n}function b(){return X.BLightApp}function w(n,t){var e=u(),r=tn(n).split("-").map(function(n){return n[0]}).join(""),i=""+r+e;return N._p[i]=t,"Agent._p."+i}function A(n,t){return new Promise(function(n){if(!H.wallet)return n(_("NLB"));if(t&&1==+t.result)try{var e=+t.cnt.errCode;if(10006===e||10004===e)return n(t)}catch(e){return n(t)}g(n,function(){return n(_("NLB"))})})}function _(n){return{result:1,cnt:{des:n,errorCode:-1}}}function C(n){X.webkit.messageHandlers[Y].postMessage(n)}function k(n){return c(n,function(t,e){return n[e]=encodeURIComponent(t)}),n}function I(n,t,e){if(H.ios){var r={successcallback:t,errorcallback:e,options:Z(n)};return H.wk?C([r]):(r=k(r),r.options=encodeURIComponent(r.options),l(""+ln+dn+"?/"+Z(r)))}b()[dn](Z(n),t,e)}function j(n){var t=void 0,e={},r=hn(n);"object"!==r?"string"===r&&(e[n]=arguments[1]):e=n,c(e,function(n,e){t=pn[e],t&&hn(t,"object")?f(n,t):pn[e]=n})}function S(n){var t="";for(var e in n)t+="&"+[e,n[e]].join("=");B("https://qianbao.baidu.com/tongji/performance/stat.jpg?pageId=agentjs"+t)}function B(n){var e=new Image;e.onload=e.onerror=e.onabort=function(){e=null},t(function(){return e.src=n})}function D(){pn.trace&&S.apply(void 0,arguments)}function L(n){return n.substr(0,32)+n.substr(n.indexOf("|"),n.length)}function O(n){try{return atob(n)}catch(n){}return n}function E(n,e,r){function i(n){r._plugins=function(n){return n?n.map(function(n){return new n(u)}):[]}(vn);var t=yn(r);return t._cloud=n,t}function o(n){return new Promise(function(e,r){function i(n){return function(t){return e({type:n,raw:t,json:function(){return y(this.raw)},decode:function(){var n=this.json().cnt;if("selectPhonefromAdressBook"===c)return O(n);var t="data";"callQRCodeScanner"===c&&(t="scanResult"),"callCamera"===c&&(t="image");try{n[t]=O(n[t])}catch(n){}return n}})}}if(n._cloud){var o=pn.clouds[c];return o?o(s,{nativeCallback:i("success")}):r(n._cloud)}var a=[w(c,i("success")),w(c,i("fail"))];a.unshift(n.params),t(function(){return I.apply(null,a)},1)})}function a(t){var e=t.json();A(c,e).then(function(){t.data=bn(r,e,t),n(t)}).catch(u)}function u(n){if(void 0!==n.cnt)return e(n.cnt);e(n)}var c=r.id,s=r.params;A(c).then(i).then(o).then(a).catch(u)}function P(n){return n in An?An[n]:n}function N(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r("undefined"!=typeof Promise,"Agent requires a Promise polyfill in this browser."),i.method_name=P(e);var o={_config:{},params:i,id:e},a=new Promise(function(n,e){return t(function(){return E(n,e,o)})});return a.set=n(a,o),a}function U(n,t){return kn.run.apply(kn,arguments)}function x(){for(var n=arguments.length,t=Array(n),e=0;e<n;e++)t[e]=arguments[e];return function(n,e,r){var i=r.value;r.value=function(){return N.apply(void 0,t).then(i)}}}function M(n){n.prototype.$Agent=N}function W(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q.title,t={};return"object"!==(void 0===n?"undefined":In(n))?t.mainTitle=n:t=f(t,n),Q.title=n,N("setTitle",t)}function T(n){return Array.isArray(n)||(n=[n]),N("setMenu",{menu_list:n.map(function(n){return{callback:w("s",n.callback||noop),title:n.title||"\u5EA6\u5C0F\u6EE1",icon:n.icon||"https://s2-8.bdimg.com/content/static/activity/2019/img/logo-duxiaoman.jpg"}})})}function $(n){return N(n?"closeTopWebview":"closeWindow")}function q(n,t){function e(){if(t)return location.replace(n);location.href=n}return N("openInNewWebView",{url:n}).then(function(n){return n.data.errCode&&e()}).catch(e)}function R(n){if(Array.isArray(n))return n.forEach(function(n){return Sn.add(n)});Sn.add(n)}function z(n){n=n?Array.isArray(n)?n:[n]:Array.from(Sn),n.length&&N("preLoadUrl",{life:20,url:n}).catch(e)}function F(n){R(n),z(n)}function V(n){return H.android?N("goToAppSetting",{permission_type:n}):N({camera:"jumpCameraSettings",location:"jumpLocationSettings",address_book:"jumpAddressBookSettings"}[n])}var G=navigator.userAgent,J=G.match(/BaiduWallet\-([\d.-_]*)/i);J=!!J&&J[1];var H={android:/(Android);?\s+([\d.]+)?/.test(G),ios:/(iPhone|iPod|iPad)/.test(G),wallet:J,box:/baiduboxapp/gi.test(G),licai:/baidulicaiapp/gi.test(G),youqian:/bdyouqianhua/gi.test(G),wk:/useWKWebView/gi.test(G)},Q=document,X=window,K=JSON.parse,Z=JSON.stringify,Y="invokeBdWalletNative",nn=/(?:^|[-_\/])(\w)/g,tn=function(n){return n.replace(/\B([A-Z])/g,"-$1").toLowerCase()},en=function(){return Math.floor(1e3*Math.random())}(),rn={events:{}},on=rn.events;rn.on=function(n,t){return(on[n]||(on[n]=[])).push(t),rn},rn.off=function(n,t){if(!n&&!t)return on=rn.events={},rn;var e=on[n];if(e)if(t)for(var r=e.length-1;r>=0;r--)e[r]===t&&e.splice(r,1);else delete on[n];return rn},rn.emit=function(n,t){var e=on[n];if(e){e=e.slice();for(var r=0,i=e.length;r<i;r++)e[r](t)}return rn};var an="bba_la_node",un="runtimeready",cn="pending";H.ios&&s("6.4")>=0||H.android?v("ready"):(rn.events.ready?rn.events.ready.unshift(d):rn.on("ready",d),p(),Q.addEventListener(un,p),X.addEventListener("load",h));var sn=0,fn=3,ln="baiduwallet://",dn="invokeBdWalletNative",pn={clouds:{},trace:!1,mapping:{ua:"getUserAgent",qr:"callQRCodeScanner",doPay:"dopay",pay:"dopay",auth:"doRnAuth",share:"callShare",camera:"callCamera",IDPhoto:"callIDPotos",bindCard:"doBindCard",position:"getCurrentPosition",getContacts:"selectPhonefromAdressBook",jumpContactSetting:"jumpAddressBookSettings"},prefetch:new Set},hn=function(n){return void 0===n?"undefined":null===n?"null":n.constructor.name.toLowerCase()},vn=[],gn=function(n){r(!n._installed,"This interceptor has been installed.","WARN");var t=function(n){return n=f(n,{before:e,finish:e,ids:null,options:{}}),function(t){var e=this;c(n,function(n,t){return e[t]=n}),this.inactive=t}}(n);return vn.push(t),n._installed=!0,t},mn=function(n){vn.includes(n)&&vn.splice(vn.indexOf(n),1)},yn=function(n){var t=n._plugins,e=n.id,r=n._config;return n._plugins=t.filter(function(n){var t=n.ids;return t?(t=Array.isArray(t)?t:[t],-1!==t.indexOf(e)?n:void 0):n}),c(n._plugins,function(t){var e=t.before,i=t.options;t.$options=function(n){var t={},e=!0;for(var r in n)i.hasOwnProperty(r)&&(t[r]=n[r],e=!1);return e?i:t}(r||{}),delete t.options,!1===e.call(t,n)&&(t._inactive=!0)}),n},bn=function(n,t,e){function r(n,t){if(t._inactive)return n;var r=t.finish.call(t,n,e);return void 0===r?n:r}return n._plugins.reduce(r,t)};gn({before:function(n){n.params.from_url=location.href}});var wn={regexp:/^(\w+)\s*(>=?|<=?)\s*([\d.]+)$/,select:function(n,t,e){if("ios"===(n=n.toLowerCase())&&!H.ios||"android"===n&&!H.android)return!0;var r=!1,i=s(e);switch(t){case"<":r=-1===i;break;case">":r=1===i;break;case"<=":r=-1===i||0===i;break;case">=":r=1===i||0===i}return r}};gn({options:{range:[">=6.1.5"]},before:function(){function n(n){return n=n.replace(/\s/g,""),n.match(wn.regexp)}function t(t){var e=n(t);return e||(e=n("all"+t)),!!e&&wn.select.apply(null,e.slice(1))}if(!this.$options.range.every(t)&&H.wallet)throw _("\u5F53\u524D\u7248\u672C\u88AB\u5FFD\u7565")}}),gn({finish:function(n){if(void 0!==n)return n.cnt}}),gn({before:function(n){var t=n.id;this.st=+new Date,this.traceId=t,D({id:t,type:"invoke",behalfOfWallet:H.behalfOfWallet})},finish:function(n){var t="";try{t=n.errCode}catch(n){}D({code:t,id:this.traceId,type:"invokeEnd",duration:+new Date-this.st})}}),gn({ids:"getDeviceInfo",finish:function(n){if(H.ios)return n;var t=n.data;return t.cuid&&(t._ag_cuid=t.cuid,t.cuid=t.cuid.substr(0,32)),t.BAIDUCUID&&(t._ag_BAIDUCUID=t.BAIDUCUID,t.BAIDUCUID=L(t.BAIDUCUID)),n}}),gn({options:{timeout:null},before:function(){var n=this;this.$options.timeout&&(this.timer=t(function(){n.inactive(_("timeout"))},this.$options.timeout))},finish:function(n){return this.timer&&clearTimeout(this.timer),n}}),gn({ids:"preOrderPay",finish:function(n,t){var e=t.json(),r=y(t.decode().data);if(0==+e.result)return r;var i=+r.errCode;return 10001===i||1e4===i?{statecode:i}:y(r.des)}}),gn({ids:"customerService",finish:function(n){if("string"!=typeof n)return n;try{return K(n.replace(/}}/g,"}}}").replace(/data":/,'data":{')).cnt}catch(t){return n}}}),gn({ids:"dopay",options:{useAuthorizeCashier:!1},before:function(n){if(this.$options.useAuthorizeCashier){if(-1!==n.params.orderInfo.indexOf("pay_from=pay_from_authorize")&&H.ios)throw location.href="https://wallet.baidu.com/cashdesk/authorize/wap/cashier?"+n.params.orderInfo,_("IOS\u4EC5\u652F\u6301H5\u6388\u6743\u652F\u4ED8")}}});var An=pn.mapping||{},_n=H.android,Cn={getEvent:function(){return X.DXMLangbridge=X.DXMLangbridge||{}},setEvent:function(n,t){var e=Cn.getEvent();rn.on(n,t),e[n]=function(){rn.emit(n)}}},kn={pageGoBack:function(n){var t="onBDWallet"+i("pageGoBack");X[t]=function(){n()},_n&&N(t)},pageshow:function(n){Cn.setEvent("onActive",n)},pagehide:function(n){Cn.setEvent("onNegative",n)},run:function(n,t){"run"!==n&&this[n]&&this[n](t)}},In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},jn={go:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return N("historyGo",{index:n}).catch(function(){return jn.go(n)})},back:function(){return this.go(-1)}};Array.from||(Array.from=function(){var n=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===n.call(t)},e=function(n){var t=Number(n);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},r=Math.pow(2,53)-1,i=function(n){var t=e(n);return Math.min(Math.max(t,0),r)};return function(n){var e=this,r=Object(n);if(null==n)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,a=arguments.length>1?arguments[1]:void 0;if(void 0!==a){if(!t(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var u,c=i(r.length),s=t(e)?Object(new e(c)):new Array(c),f=0;f<c;)u=r[f],s[f]=a?void 0===o?a(u,f):a.call(o,u,f):u,f+=1;return s.length=c,s}}());var Sn=pn.prefetch,Bn='link[rel="next"]';return N.OS=H,N.version="2.0.2",N._p={},N.on=U,N.config=j,N.setTitle=W,N.setMenu=T,N.closeWindow=$,N.descriptor=x,N.install=M,N.versionCompare=s,N.open=q,N.history=jn,N.setAuthorization=V,N.schema=l,N.interceptors={use:gn,eject:mn},N.preload=F,function(){R(Array.from(Q.querySelectorAll(Bn)).map(function(n){return n.href})),z()}(),N.on("pageshow",z),X.Vue&&X.Vue.use(N),X.addEventListener("unhandledrejection",function(n){try{"NLB"===n.reason.des&&n.preventDefault()}catch(n){}}),N}();
